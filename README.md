# Emotions_Detection_STM32_F446RE

This repository contains all files related to my master's thesis entitled "multimodal emotion detection system". Since recognizing emotions has been a very explored topic recently, as evidenced by the increase in the number of scientific articles, I decided to delve deeper into this topic.
For the purposes of my work, I decided to use biomedical signals generated by the autonomic nervous system, the operation of which is largely independent of human intentions.

For the purposes of this work, the focus was on three signals:
- Respiratory signal
- Electrodermal signal (EDA)
- electrocardiographic signal (ECG)

![image](https://github.com/Shooterqq/Emotions_Detection_STM32_F446RE/assets/102792345/c6f3b923-69de-4b9c-8305-bb133e91dbe5)
![image](https://github.com/Shooterqq/Emotions_Detection_STM32_F446RE/assets/102792345/b4771af3-d232-48c7-9ae0-787ced5a5d5b)

These signals were obtained thanks to appropriate modules placed on the respondents' bodies during research involving watching video content evoking a wide spectrum of emotions (7 different emotions). The acquisition of signals from the sensors was carried out by an appropriately programmed stm32 microcontroller, which acquired on 5 ADC channels with a sampling frequency of 1 kHz.

Using MATLAB software, after collecting the signal database, they were filtered using FIR filters and wavelet transform.
![image](https://github.com/Shooterqq/Emotions_Detection_STM32_F446RE/assets/102792345/e396144e-f78d-4cf4-a5a1-5762277076e0)
![image](https://github.com/Shooterqq/Emotions_Detection_STM32_F446RE/assets/102792345/1291d16d-bdbf-461a-88ba-f78500479289)
![image](https://github.com/Shooterqq/Emotions_Detection_STM32_F446RE/assets/102792345/91f09a2b-8777-4d7f-b47a-9d06946bed96)

Then, feature extraction was performed, including the use of optimization methods on the EDA signal to separate the SCR component from the SCL. Heart rate (HR) and HRV were also calculated using the discrete wavelet transform. Using the wavelet transform and the Symlet4 wavelet, the respondents' breathing rate was also calculated.
![image](https://github.com/Shooterqq/Emotions_Detection_STM32_F446RE/assets/102792345/d10b410a-b0ac-4f66-b4b0-237dd2206455)
![image](https://github.com/Shooterqq/Emotions_Detection_STM32_F446RE/assets/102792345/56a8f04c-e2c5-41d1-9a76-29ff721d2c68)

The extracted features were fed into machine learning, as a result of which two neural networks were trained, one with an emotion recognition efficiency of 78.6% and the other, after taking into account corrections and conducting additional tests, with 100% efficiency.
![image](https://github.com/Shooterqq/Emotions_Detection_STM32_F446RE/assets/102792345/0b98357a-6aee-4267-ba0e-4f2e5d36988f)
![image](https://github.com/Shooterqq/Emotions_Detection_STM32_F446RE/assets/102792345/1b8b2d3b-67dc-4dc8-bb7d-43c8a2c73113)

Based on the results, a detailed model of the target device was created in a modular form, where the main device would be a smartwatch.
![image](https://github.com/Shooterqq/Emotions_Detection_STM32_F446RE/assets/102792345/deefa8e1-dec7-4c57-8774-3fa78a96ec5a)

The work was widely appreciated by reviewers. Currently, an article based on the work is being written for a scientific journal together with my supervisor.
â€‹

Please check for more informations "Piotr Wiski - Prezentacja dyplomowa.pptx"

